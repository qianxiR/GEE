# 基于Google Earth Engine的智能水体提取系统

## 项目简介

本项目是基于Google Earth Engine (GEE) 开发的智能水体提取系统，集成了数据下载、预处理和高级水体识别算法。系统采用随机森林机器学习算法结合多种水体指数，实现高精度的水体自动提取。主要面向水资源监测、环境变化分析和遥感科研应用。

## 功能特点

### 🧠 智能水体提取算法
- **随机森林分类**：基于机器学习的监督分类算法
- **OTSU自适应阈值**：自动确定最佳分割阈值，无需人工设定
- **多指数融合**：结合5种水体指数提高识别精度
- **形态学优化**：后处理去除噪声，填充孔洞

### 🛰️ 多源卫星数据支持
- **Sentinel-2系列**：地表反射率(SR)、大气层顶反射率(TOA)、云概率产品
- **Landsat系列**：Landsat-8/9 Collection 2 数据
- **云检测增强**：Cloud Score Plus 优化数据

### 🗺️ 灵活的区域选择
- 支持中国主要省份和城市选择
- 可视化地图交互界面
- 自定义研究区域绘制

### ⏰ 时间范围控制
- 2015-2025年数据覆盖
- 精确到日期的起止时间选择
- 自动日期有效性验证

### 📊 智能数据处理
- 中值合成算法减少云层影响
- 自动波段选择和参数配置
- 分区导出避免内存溢出

## 文件结构

```
水体提取_哨兵/
├── 数据下载/                    # 数据下载模块
│   ├── 哨兵_dataview.js         # Sentinel-2数据下载脚本
│   ├── 按省或区下载数据.js       # 区域化数据下载
│   ├── 资产数据单个下载.js       # 单个资产数据下载
│   ├── 资产数据批量下载.js       # 批量资产数据下载
│   └── 陆地资源_dataview.js     # Landsat数据下载脚本
├── 数据预处理/                  # 数据预处理模块
├── 算法/                        # 核心算法模块
│   └── detph_rf.js             # 随机森林水体提取算法
└── README.md                    # 项目说明文档
```

## 使用方法

### 方法一：图形化界面（推荐）

1. **打开Google Earth Engine Code Editor**
   - 访问 [https://code.earthengine.google.com/](https://code.earthengine.google.com/)
   - 登录您的Google账户

2. **导入主程序**
   - 将 `dataget_app.js` 中的代码复制到Code Editor
   - 点击"Run"运行程序

3. **配置下载参数**
   - 选择目标影像类型
   - 设置研究时间范围
   - 选择研究区域（省份/城市）
   - 点击"下载数据"按钮

4. **监控下载进度**
   - 在Tasks面板查看任务状态
   - 下载完成后在Google Drive中获取数据

### 方法二：脚本化处理

#### 勒内地区数据下载
```javascript
// 运行 dataget_lene.js
// 自动下载2025年6-10月Sentinel-2数据
// 使用0.3度网格分区导出
```

#### 玉树地区数据下载
```javascript
// 运行 dataget1_yushu.js
// 自动下载2025年6-7月Sentinel-2数据
// 使用0.3度网格分区导出
```

## 支持的影像数据集

### Sentinel-2 系列
| 数据集 | 类型 | 分辨率 | 用途 |
|--------|------|--------|------|
| `COPERNICUS/S2_SR_HARMONIZED` | 地表反射率 | 10m | 植被监测、土地利用分类 |
| `COPERNICUS/S2_HARMONIZED` | 大气层顶反射率 | 10m | 需要自定义大气校正 |
| `COPERNICUS/S2_CLOUD_PROBABILITY` | 云概率 | 10m | 云检测、数据质量控制 |
| `CLOUD_SCORE_PLUS_HARMONIZED/S2_HARMONIZED_V1` | 云评分增强 | 10m | 高质量无云数据 |

### Landsat 系列
| 数据集 | 类型 | 分辨率 | 用途 |
|--------|------|--------|------|
| `LANDSAT/LC08/C02/T1_TOA` | Landsat-8 TOA | 30m | 长时间序列分析 |
| `LANDSAT/LC08/C02/T1` | Landsat-8 原始 | 30m | 自定义处理流程 |
| `LANDSAT/LC09/C02/T1_TOA` | Landsat-9 TOA | 30m | 高时间分辨率监测 |

## 技术特性

### 分区导出算法
- **网格划分**：将大区域分割为0.3度×0.3度网格
- **内存优化**：避免单次处理数据量过大
- **并行处理**：支持多分区同时导出
- **自动命名**：按网格ID和位置自动命名文件

### 数据预处理
- **云量筛选**：自动过滤云量>20%的影像
- **中值合成**：减少云层和大气影响
- **波段选择**：根据影像类型自动选择最佳波段组合
- **几何裁剪**：精确裁剪到研究区域边界

## 输出格式

- **文件格式**：GeoTIFF
- **坐标系统**：WGS84 (EPSG:4326)
- **存储位置**：Google Drive
- **文件命名**：`{影像类型}_{区域名称}_{时间}_partition_{网格ID}.tif`

## 系统要求

- Google Earth Engine账户
- 现代Web浏览器（Chrome、Firefox、Safari）
- Google Drive存储空间
- 稳定的网络连接

## 注意事项

1. **配额限制**：GEE有每日导出配额限制，大区域数据建议分批下载
2. **存储空间**：确保Google Drive有足够存储空间
3. **处理时间**：大区域数据处理可能需要较长时间
4. **数据质量**：建议选择云量较少的时段进行下载

## 常见问题

### Q: 下载任务失败怎么办？
A: 检查GEE配额是否充足，尝试减小研究区域或时间范围。

### Q: 如何合并分区数据？
A: 使用QGIS、ArcGIS等GIS软件的"合并栅格"功能。

### Q: 支持其他地区吗？
A: 可以修改代码中的行政区划数据，添加更多地区。

### Q: 数据精度如何？
A: Sentinel-2为10米分辨率，Landsat为30米分辨率，满足大多数应用需求。

## 更新日志

- **v1.0** (2025-01-XX)
  - 初始版本发布
  - 支持Sentinel-2和Landsat数据下载
  - 实现图形化界面和分区导出功能

## 许可证

本项目仅供学习和研究使用，请遵守Google Earth Engine的使用条款。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目Issues：[GitHub Issues链接]
- 邮箱：[您的邮箱]

---

**免责声明**：本工具仅用于科研和学习目的，使用者需自行承担数据使用责任，并遵守相关法律法规。


